<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Jichao Ouyang's Blogist</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="username" content="">
		<meta name="description" content="<img src=https://travis-ci.org/jcouyang/blogist.svg> or failed">
    <link rel="stylesheet" href="/bower_components/bootswatch/flatly/bootstrap.min.css" media="screen">

		<link rel="stylesheet" href="https://gist.github.com/assets/embed-91ddfaf352483e316b5398263e92b3e0.css" media="screen">
		<link rel="stylesheet" href="/stylesheets/blogist.css" media="screen">
		<script>
			if(window.location.pathname!="/"){
	window.location = window.location.origin + "#" +window.location.pathname.replace(".html","");
			}
			</script>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
				<script src="/bower_components/bootswatch/bower_components/html5shiv/dist/html5shiv.js"></script>
				<script src="/bower_components/bootswatch/bower_components/respond/dest/respond.min.js"></script>
				<![endif]-->
		
  </head>
  <body>
		<div class="container">

			<div class="row">
				<div class="sidebar col-md-2">
				</div>

				<div class="col-md-8">

					<div class="article">
						<div id="gist13968076" class="gist">
        <div class="gist-file">
          <div class="gist-data gist-syntax">
            

    <div class="readme context-loader-container context-loader-overlay">
      <article class="markdown-body js-file "
        data-task-list-update-url="https://gist.github.com/jcouyang/34686f695cd28309759e/file/3-reason-to-use-jest-to-test-your-javascript.md">
        <ul class="task-list">
<li><a href="https://rawgit.com/jcouyang/cc0e65e36af9c7c001e2/raw/b100f45ebfe7c196043cb10f967123f9ebde7ffc/1-painless-javascript-testing.html#/28" rel="noreferrer">slides</a></li>
<li><a href="https://github.com/jcouyang/jest-sample" rel="noreferrer">source</a></li>
</ul>

<p>Javascript çš„æµ‹è¯•, ä¸ç®¡åœ¨ç”¨ <a href="http://jasmine.github.io" rel="noreferrer">jasmine</a> è¿˜æ˜¯ <a href="http://visionmedia.github.io/mocha/" rel="noreferrer">mocha</a>,
éƒ½æ˜¯å¾ˆå¤´ç–¼çš„äº‹æƒ…. ä½†æ˜¯è‡ªä»æœ‰äº† <a href="http://facebook.github.io/jest/" rel="noreferrer">jest</a>, ä¸€å£æ°”å†™7ä¸ªæµ‹è¯•, è…°ä¹Ÿä¸ç–¼äº†, å¤´ä¹Ÿä¸ç–¼äº†.</p>

<p>åªéœ€è¦ 3 ä¸ªç†ç”±</p>

<p>åœ¨è¯´ç”¨ jest æµ‹ä¸ºä»€ä¹ˆå¥½ä¹‹å‰,æˆ‘ä»¬å…ˆæ¥çœ‹æˆ‘ä»¬è¦æµ‹çš„ä¸€ä¸ªä¾‹å­.</p>

<h2>
<a name="user-content-" class="anchor" href="#" rel="noreferrer"><span class="octicon octicon-link"></span></a>ğŸŒ°</h2>

<p>æ¯”å¦‚æˆ‘è¦å†™ä¸€ä¸ªæ¨¡å—è¦å»å–github ç”¨æˆ·çš„follower å’Œä»–æ‰€æœ‰ repo çš„ follower æ•°é‡.</p>

<p>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ª User çš„ Model.</p>

<div class="highlight highlight-js"><pre><span class="pl-c">// user.js</span>
<span class="pl-s">var</span> $ <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>jquery<span class="pl-pds">'</span></span>);
<span class="pl-st">function</span> <span class="pl-en">User</span>(<span class="pl-vpf">name</span>) {
  <span class="pl-v">this</span>.<span class="pl-sc">name</span> <span class="pl-k">=</span> name;
  <span class="pl-v">this</span>.followers <span class="pl-k">=</span> <span class="pl-c1">0</span>;
}
<span class="pl-s3">User</span>.<span class="pl-sc">prototype</span>.<span class="pl-en">fetch</span> <span class="pl-k">=</span> <span class="pl-st">function</span>(){
  <span class="pl-k">return</span> $.ajax({
    url<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>https://api.github.com/users/<span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-v">this</span>.<span class="pl-sc">name</span>,
    method<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>get<span class="pl-pds">'</span></span>,
    dataType<span class="pl-k">:</span> <span class="pl-s1"><span class="pl-pds">'</span>json<span class="pl-pds">'</span></span>
  }).then(<span class="pl-st">function</span>(<span class="pl-vpf">data</span>){
      <span class="pl-v">this</span>.followers <span class="pl-k">=</span> data.followers;
  }.bind(<span class="pl-v">this</span>));
};
<span class="pl-sv">module</span>.exports <span class="pl-k">=</span> User;</pre></div>

<p>æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª repo çš„ model, å¤§åŒå°å¼‚ç•¥å»</p>

<p>æœ€å, æ•´åˆè¿™ä¿©æˆ‘è¦çš„ä¸œè¥¿, å¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š</p>

<div class="highlight highlight-js"><pre><span class="pl-c">// follower.js</span>
<span class="pl-s">var</span> $ <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>jquery<span class="pl-pds">'</span></span>);
<span class="pl-st">function</span> <span class="pl-en">followerOf</span>(<span class="pl-vpf">user</span>, <span class="pl-vpf">repo</span>) {
  user.fetch().then(repo.fetch).then(<span class="pl-st">function</span>(<span class="pl-vpf">_</span>){
    $(<span class="pl-s1"><span class="pl-pds">'</span>#content<span class="pl-pds">'</span></span>).<span class="pl-sc">text</span>(user.<span class="pl-sc">name</span> <span class="pl-k">+</span><span class="pl-s1"><span class="pl-pds">"</span>'s followers: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> user.followers <span class="pl-k">+</span>
                       <span class="pl-s1"><span class="pl-pds">"</span> and his repo <span class="pl-pds">"</span></span><span class="pl-k">+</span> repo.<span class="pl-sc">name</span> <span class="pl-k">+</span><span class="pl-s1"><span class="pl-pds">"</span>'s followers:<span class="pl-pds">"</span></span> <span class="pl-k">+</span> repo.followers);
    });
};

<span class="pl-sv">module</span>.exports <span class="pl-k">=</span> followerOf;</pre></div>

<h2></h2>

<h2>
<a name="user-content-1-auto-mock" class="anchor" href="#1-auto-mock" rel="noreferrer"><span class="octicon octicon-link"></span></a>1. Auto Mock</h2>

<p>è‡ªåŠ¨ mock å®åœ¨æ˜¯æœ€å¤§çš„äº®ç‚¹, jest é‡å†™äº† require, æ‰€ä»¥ä½ çš„ä»£ç é‡Œçš„æ‰€æœ‰ require æ¥çš„ä¸œè¥¿éƒ½è‡ªåŠ¨ mock.</p>

<p>å› ä¸ºåœ¨ä½ çš„æµ‹è¯•ä¸­å¾€å¾€åªå…³å¿ƒä¸€ä¸ªæ¨¡å—, å¯¹äºä»–çš„æ‰€æœ‰ä¾èµ–å…¶å®éƒ½æ˜¯æ— æ‰€è°“çš„.</p>

<p>åœ¨ä¾‹å­ä¸­, å¦‚æœæˆ‘ä»¬åœ¨æµ‹ repo.js çš„æ—¶å€™å®Œå…¨ä¸å…³å¿ƒé‚£ä¸¤ä¸ª jquery çš„ ajax æ–¹æ³•åˆ°åº•
å†™å¯¹æ²¡å†™å¯¹,åæ­£æˆ‘ä»¬æœŸæœ›èƒ½ä» ajax é‡Œé¢æ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿å°±å¯¹äº†. å› æ­¤, æˆ‘å¸Œæœ› jquery çš„
æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯ mock çš„. jest è®©ä½ å¾ˆè½»æ¾çš„åšåˆ°è¿™ç‚¹, å› ä¸ºæ˜¯è‡ªåŠ¨mockæ‰€æœ‰require çš„ä¸œè¥¿, è€Œ
å¯¹äºç›®æ ‡æµ‹è¯•æ¨¡å—, åªéœ€è¦è¯´æˆ‘<code>dontMock</code> æˆ‘çš„ç›®æ ‡æ¨¡å—å°±å¥½äº†.</p>

<div class="highlight highlight-js"><pre>jest.dontMock(<span class="pl-s1"><span class="pl-pds">'</span>../repo<span class="pl-pds">'</span></span>);
describe(<span class="pl-s1"><span class="pl-pds">'</span>Repo Model<span class="pl-pds">'</span></span>, <span class="pl-st">function</span>(){
  <span class="pl-s">var</span> repo;
  beforeEach(<span class="pl-st">function</span>(){
        <span class="pl-s">var</span> $ <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>jquery<span class="pl-pds">'</span></span>).setAjaxReturn({stargazers_count<span class="pl-k">:</span> <span class="pl-c1">23</span>});
        <span class="pl-s">var</span> Repo <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>../repo<span class="pl-pds">'</span></span>);
    repo <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Repo</span>(<span class="pl-s1"><span class="pl-pds">'</span>jcouyang<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>gira<span class="pl-pds">'</span></span>);

    });

  it(<span class="pl-s1"><span class="pl-pds">'</span>should populate properties with data from github api<span class="pl-pds">'</span></span>, <span class="pl-st">function</span>(){
        repo.fetch();
        expect(repo.followers).toBe(<span class="pl-c1">23</span>);
  });
});
</pre></div>

<p>æ‰€ä»¥è¿™ä¸ªæµ‹è¯•çœ‹èµ·æ¥å°±è·Ÿæ–‡æ¡£ä¸€æ ·äº†,</p>

<ol class="task-list">
<li>
<code>dontMock('./repo')</code> è¯´æ˜æˆ‘å…³å¿ƒ<code>repo</code>
è¿™ä¸ªæ¨¡å—, å…¶ä»–æˆ‘éƒ½ä¸ care.</li>
<li>before æ˜¯æˆ‘è¦è¿›è¡Œæ“ä½œæ‰€éœ€è¦çš„ä¸œè¥¿.

<ul class="task-list">
<li>æˆ‘è¦ jquery ajax è¯·æ±‚ç»™æˆ‘æƒ³è¦çš„æ•°æ®</li>
<li>æˆ‘è¦ä¸€ä¸ªæˆ‘è¦æµ‹çš„ Repo ç±»çš„å®ä¾‹</li>
</ul>
</li>
<li>it è¯´æ˜æˆ‘å…³å¿ƒåœ°è¡Œä¸ºæ˜¯ç¥é©¬

<ul class="task-list">
<li>æˆ‘å…³å¿ƒ fetch çš„è¡Œä¸º,æ˜¯å»å–æ•°æ®å¹¶ç»™æˆ‘æŠŠæ•°æ®å¡«å……åˆ°æˆ‘çš„ repo å®ä¾‹ä¸­</li>
</ul>
</li>
</ol>

<blockquote>
<p>ä½ å¯èƒ½è¦é—® <code>segAjaxReturn</code> æ˜¯å“ªé‡Œå†’å‡ºæ¥çš„. å¿ä¸€å¿ç¨åå‘Šè¯‰ä½ .</p>
</blockquote>

<p>æœ‰æ²¡æœ‰çœ‹è™½ç„¶æˆ‘æ˜¾å¼çš„ mock jquery, ä½†æ˜¯ Repo é‡Œé¢ require çš„ jquery å…¶å®æ˜¯å‡çš„, ä¸ç„¶æˆ‘ä»¬å°±çœŸçš„è®¿é—®
github api äº†. é‚£æ ·å°±ä¸ä¼šæ¯æ¬¡éƒ½è¿”å› 23 ä¸ª follower äº†.</p>

<h2>
<a name="user-content-2-jsdom" class="anchor" href="#2-jsdom" rel="noreferrer"><span class="octicon octicon-link"></span></a>2. jsdom</h2>

<p>å¥½äº†ç°åœ¨æˆ‘ä»¬æ¥æµ‹ follower.js, å…ˆçœ‹ follower åˆ°åº•å¹²äº†ä»€ä¹ˆ, æ‹¿åˆ° user å’Œ repo
çš„ä¿¡æ¯ç„¶åç»„æˆä¸€å¥è¯æ”¾åˆ°é¡µé¢ id ä¸º content çš„å…ƒç´ ä¸‹é¢.</p>

<p>å¥½, æ‰€ä»¥æˆ‘ä»¬å…³å¿ƒ</p>

<ul class="task-list">
<li>ç»„å‡ºæ¥çš„è¯å¯¹ä¸å¯¹</li>
<li>æœ‰æ²¡æœ‰æ”¾åˆ° content å…ƒç´ ä¸‹, æ‰€ä»¥ jquery çš„æ“ä½œå¯¹ä¸å¯¹ä¹Ÿæ˜¯æˆ‘ä»¬å…³å¿ƒçš„ä¸€éƒ¨åˆ†</li>
</ul>

<p>æˆ‘ä»¬ä¸å…³å¿ƒ</p>

<ul class="task-list">
<li>user å¹²äº†ä»€ä¹ˆ</li>
<li>repo å¹²äº†ä»€ä¹ˆ</li>
</ul>

<p>è¿™æ ·,å…³å¿ƒçš„å°±æ˜¯ä¸èƒ½ mock çš„</p>

<div class="highlight highlight-js"><pre>jest.dontMock(<span class="pl-s1"><span class="pl-pds">'</span>../follower<span class="pl-pds">'</span></span>)
    .dontMock(<span class="pl-s1"><span class="pl-pds">'</span>jquery<span class="pl-pds">'</span></span>);
describe(<span class="pl-s1"><span class="pl-pds">'</span>follower<span class="pl-pds">'</span></span>, <span class="pl-st">function</span>(){
  <span class="pl-s">var</span> user, repo, follower;
    <span class="pl-s">var</span> $ <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>jquery<span class="pl-pds">'</span></span>);
  beforeEach(<span class="pl-st">function</span>(){
        <span class="pl-s">var</span> Repo <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>../repo<span class="pl-pds">'</span></span>);
        <span class="pl-s">var</span> User <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>../user<span class="pl-pds">'</span></span>);
        follower <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>../follower<span class="pl-pds">'</span></span>);
        user <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">User</span>(<span class="pl-s1"><span class="pl-pds">'</span>jcouyang<span class="pl-pds">'</span></span>);
    repo <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Repo</span>(<span class="pl-s1"><span class="pl-pds">'</span>jcouyang<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>gira<span class="pl-pds">'</span></span>);
    <span class="pl-c">// æˆ‘ä»¬ä¸å…³å¿ƒ user, ä½†æ˜¯æˆ‘ä»¬å¸Œæœ›ä»–èƒ½è¿”å›ä¸€ä¸ª deferred ç±»å‹</span>
      user.fetch.mockReturnValue($.Deferred().resolve(<span class="pl-s1"><span class="pl-pds">'</span>dont care<span class="pl-pds">'</span></span>));
    <span class="pl-c">// æˆ‘ä»¬è®©æˆ‘ä»¬ä¸å…³å¿ƒçš„ user å’Œ repo è¿”å›æˆ‘ä»¬æœŸæœ›çš„ä¸œè¥¿å°±å¥½</span>
        user.<span class="pl-sc">name</span> <span class="pl-k">=</span><span class="pl-s1"><span class="pl-pds">'</span>jcouyang<span class="pl-pds">'</span></span>;
        user.followers <span class="pl-k">=</span> <span class="pl-c1">20</span>;
        repo.<span class="pl-sc">name</span> <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">'</span>gira<span class="pl-pds">'</span></span>;
        repo.followers <span class="pl-k">=</span> <span class="pl-c1">21</span>;
    <span class="pl-c">// æœŸå¾…é¡µé¢ä¸Šæœ‰ä¸€ä¸ª  id ä¸º content çš„å…ƒç´ </span>
        <span class="pl-s3">document</span>.<span class="pl-sc">body</span>.innerHTML <span class="pl-k">=</span> <span class="pl-s1"><span class="pl-pds">'</span>&lt;div id="content"&gt;&lt;/div&gt;<span class="pl-pds">'</span></span>;
    });

  it(<span class="pl-s1"><span class="pl-pds">'</span>should populate properties with data from github api<span class="pl-pds">'</span></span>, <span class="pl-st">function</span>(){
        follower(user,repo);
    <span class="pl-c">// å¸Œæœ› content ä¸Šèƒ½å¾—åˆ°æƒ³è¦çš„å†…å®¹</span>
        expect($(<span class="pl-s1"><span class="pl-pds">"</span>#content<span class="pl-pds">"</span></span>).<span class="pl-sc">text</span>()).toBe(<span class="pl-s1"><span class="pl-pds">'</span>jcouyang<span class="pl-cce">\'</span>s followers: 20 and his repo gira<span class="pl-cce">\'</span>s followers:21<span class="pl-pds">'</span></span>);
  });
});
</pre></div>

<h2>
<a name="user-content-3-manual-mock" class="anchor" href="#3-manual-mock" rel="noreferrer"><span class="octicon octicon-link"></span></a>3. Manual Mock</h2>

<p>å¥½äº†, è¯´å¥½çš„è§£é‡Š <code>setAjaxReturn</code>æ˜¯æ€ä¹ˆå›äº‹çš„</p>

<p>å—¯å—¯, æ˜¯è¿™æ ·çš„, è™½ç„¶ jest è‡ªåŠ¨ mock äº†æˆ‘ä»¬ä¸å…³å¿ƒçš„æ¨¡å—, ä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯ä¼šå¸Œæœ›
è¿™ä¸ª mock çš„ç©æ„èƒ½æœ‰ä¸€äº›æˆ‘ä»¬æœŸæœ›çš„è¡Œä¸º, ä¹Ÿå°±æ˜¯æŒ‰æˆ‘ä»¬çš„æœŸæœ›è¿”å›ä¸€äº›ä¸œè¥¿. æ¯”å¦‚
è¿™é‡Œå°±æ˜¯æˆ‘ä»¬ä¸å…³å¿ƒ ajax çš„é€»è¾‘, ä½†æ˜¯æˆ‘ä»¬éœ€è¦ä»–èƒ½ç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªä¸œè¥¿,å¹¶ä¸”å¯ä»¥
thenable. æ‰€ä»¥å•çº¯çš„ mock å¯¹è±¡æˆ–å‡½æ•°éƒ½ä¸èƒ½åšåˆ°, æ‰€ä»¥æœ‰äº† manual mock è¿™ç§ä¸œè¥¿.</p>

<p>ç”¨ manual mock éœ€è¦å»ºä¸€ä¸ª<code>__ mocks__</code> æ–‡ä»¶å¤¹,ç„¶åæŠŠæ‰€æœ‰çš„ mock éƒ½æ‰”è¿›å». æ¯”å¦‚
æˆ‘æƒ³ mock jquery, é‚£ä¹ˆæˆ‘å»ºä¸€ä¸ª<code>jquery.js</code> æ‰”è¿›å»</p>

<div class="highlight highlight-javascript"><pre><span class="pl-s">var</span> data <span class="pl-k">=</span> {};
<span class="pl-s">var</span> <span class="pl-en">mockDefered</span> <span class="pl-k">=</span> <span class="pl-st">function</span>(<span class="pl-vpf">data</span>){
    <span class="pl-k">return</span> {
        <span class="pl-en">then</span>: <span class="pl-st">function</span>(<span class="pl-vpf">cb</span>){
            <span class="pl-k">return</span> mockDefered(cb(data));
        }
    };
};

<span class="pl-st">function</span> <span class="pl-en">ajax</span>() {
  <span class="pl-k">return</span> mockDefered(data);
}

<span class="pl-st">function</span> <span class="pl-en">setAjaxReturn</span>(<span class="pl-vpf">shouldbe</span>){
    data <span class="pl-k">=</span> shouldbe;
}
<span class="pl-sv">exports</span>.setAjaxReturn <span class="pl-k">=</span> setAjaxReturn;
<span class="pl-sv">exports</span>.ajax <span class="pl-k">=</span> ajax;
</pre></div>

<p>ç»ˆäºçœ‹è§<code>setAjaxReturn</code>åœ¨å“ªé‡Œå®šä¹‰äº†<img align="absmiddle" alt=":sweat_smile:" class="emoji" height="20" src="https://gist-assets.github.com/assets/emoji/unicode/1f605-1776547fd68545817d4ee4169ed73cc4.png" title=":sweat_smile:" width="20"> è¿™é‡Œæš´éœ²ä¸¤ä¸ªå‡½æ•°</p>

<ul class="task-list">
<li>setAjaxReturn: å¯ä»¥è®¾ç½®æˆ‘å¸Œæœ› ajax è¿”å›çš„å€¼</li>
<li>ajax: å•çº¯çš„è¿”å›è¿™ä¸ª thenable.</li>
</ul>

<p>æ‰€ä»¥æˆ‘ä¹Ÿä¸éœ€è¦æ˜¾ç¤ºçš„å£°æ˜ mock jqueryä»€ä¹ˆä»€ä¹ˆçš„, ç›´æ¥åœ¨æµ‹è¯•é‡Œè®¾ç½®ajax çš„è¿”å›å€¼å°±å¥½äº†.</p>

<div class="highlight highlight-js"><pre><span class="pl-s">var</span> $ <span class="pl-k">=</span> <span class="pl-s3">require</span>(<span class="pl-s1"><span class="pl-pds">'</span>jquery<span class="pl-pds">'</span></span>).setAjaxReturn({stargazers_count<span class="pl-k">:</span> <span class="pl-c1">23</span>});</pre></div>

<p>è¿™æ˜¯ repo é‡Œé¢ require çš„ jquery å·²ç»è¢« mock å¹¶ä¸”åªè¦æ‰ ajax éƒ½ä¼šè¿”å›æˆ‘
æœŸæœ›çš„å€¼.</p>

<h2>
<a name="user-content-etc" class="anchor" href="#etc" rel="noreferrer"><span class="octicon octicon-link"></span></a>etc</h2>

<ul class="task-list">
<li>
<strong>å¹¶è¡Œæµ‹è¯•</strong>:
è¿˜ç”¨è¯´ä¹ˆ, æ—¢ç„¶å·²ç»å¦‚æ­¤æ¨¡å—åŒ–å¥½äº†, user repo ä»¥åŠ follower çš„æµ‹è¯•å®Œå…¨æ˜¯äº’ä¸ä¾èµ–.
æ²¡æœ‰ä»€ä¹ˆç†ç”±ä¸€ä¸ªä¸€ä¸ªæµ‹. å› æ­¤3ä¸ªæµ‹è¯•çš„è€—æ—¶å–å†³äºæœ€é•¿æ—¶é—´çš„é‚£ä¸ª. æ‰€ä»¥å¦‚æœæœ‰
é‚£ä¸ªæµ‹è¯•ç‰¹åˆ«è€—æ—¶,è¯´æ˜æ¨¡å—è¿˜ä¸å¤Ÿç»†, å¤šæ‹†å‡ ä¸ªå°±å¿«äº†.</li>
<li>
<strong>promise</strong>: ä½¿ç”¨ pit() æ¥æµ‹è¯• thenable çš„å¯¹è±¡, æ¯”å¦‚ repo çš„ä¾‹å­,å°± keyi
å†™æˆ</li>
</ul>

<div class="highlight highlight-javascript"><pre>pit(<span class="pl-s1"><span class="pl-pds">'</span>should populate properties with data from github api<span class="pl-pds">'</span></span>, <span class="pl-st">function</span>(){
  <span class="pl-k">return</span> repo.fetch().then(
    expect(repo.followers).toBe(<span class="pl-c1">23</span>);
  );
});</pre></div>

<ul class="task-list">
<li>
<strong>Timer mocks</strong>: å¯ä»¥ä½¿ç”¨ mock çš„ timer å’Œ ticks, ä¹Ÿå°±æ˜¯ä½ å¯ä»¥åŠ é€Ÿ
æ‰€æœ‰çš„setTimeout, setInterval, clearTimeout, clearIntervalè¡Œä¸º. ä¸éœ€è¦ç­‰å¾….</li>
</ul>

<div class="highlight highlight-js"><pre><span class="pl-s3">setTimeout</span>(<span class="pl-st">function</span>() { callback(); }, <span class="pl-c1">1000</span>);
 expect(callback).not.toBeCalled();
 jest.runAllTimers();
expect(callback).toBeCalled()</pre></div>

<hr>

<h2>
<a name="user-content-wrapup" class="anchor" href="#wrapup" rel="noreferrer"><span class="octicon octicon-link"></span></a>Wrapup</h2>

<p>æ‰€ä»¥è¯´ç™½äº†, jest å…¶å®ä¹Ÿæ˜¯ä¸ªæ¦‚å¿µ, æ¨èä½¿ç”¨æ¨¡å—åŒ–çš„æ€æƒ³, è¿™æ ·æˆ‘åªéœ€è¦ä¿è¯æ¯ä¸ªæ¥å£çš„ IO æ­£ç¡®, å°±å¯ä»¥ä¿è¯æ•´ä¸ªç¨‹åºæ²¡é—®é¢˜. è¿™æ ·åˆ’åˆ†ä¸‹æ¥æµ‹è¯•å°±ä¼šå˜å¾—ç®€å•åˆ°åªéœ€è¦å…³å¿ƒå½“ç„¶æ¨¡å—çš„ IO ä»è€Œ
å¯ä»¥ mock æ‰æ‰€æœ‰å…¶ä»–ä¾èµ–. çœŸæ­£æ¨¡å—åŒ–å¥½çš„ä»£ç å•çº¯çš„åªç”¨ jasmine æˆ–è€… mocha
éƒ½åº”è¯¥æ˜¯å¾ˆå¥½æµ‹çš„. åªæ˜¯åœ¨è¿™ä¸ªæ¦‚å¿µä¹‹ä¸Šçœå»äº†å¾ˆå¤šä¸å¿…è¦çš„ mock ä»£ç , å› ä¸ºè¦ mock çš„
ä¾èµ–æ€»æ˜¯å å¤§å¤šæ•°çš„, è€Œå…³å¿ƒçš„, å¾€å¾€åªæ˜¯é‚£ä¹ˆä¸€ä¸¤ä¸ª.</p>

<p><a href="https://camo.githubusercontent.com/3e64dbaa084ae3840bbef387c170dbdbee7d9b33/68747470733a2f2f67612d626561636f6e2e61707073706f742e636f6d2f55412d33323331343135342d352f626c6f676973742f332d726561736f6e2d746f2d7573652d6a657374" target="_blank" rel="noreferrer"><img src="https://camo.githubusercontent.com/3e64dbaa084ae3840bbef387c170dbdbee7d9b33/68747470733a2f2f67612d626561636f6e2e61707073706f742e636f6d2f55412d33323331343135342d352f626c6f676973742f332d726561736f6e2d746f2d7573652d6a657374" alt="Analytics" data-canonical-src="https://ga-beacon.appspot.com/UA-32314154-5/blogist/3-reason-to-use-jest" style="max-width:100%;"></a></p>

      </article>
    </div>



          </div>
          <div class="gist-meta">
            <a href="https://gist.github.com/jcouyang/34686f695cd28309759e/raw/3-reason-to-use-jest-to-test-your-javascript.md" style="float:right">view raw</a>
            <a href="https://gist.github.com/jcouyang/34686f695cd28309759e#file-3-reason-to-use-jest-to-test-your-javascript-md">3-reason-to-use-jest-to-test-your-javascript.md</a>
            hosted with &#10084; by <a href="https://github.com">GitHub</a>
          </div>
        </div>
</div>

					</div>
				</div>
				<div class="sidebar col-md-2">
				</div>
			</div>	
		</div>

		<footer>
      <div class="container">
				<div class="row">
					<div class="col-md-2">
					</div>

					<div class="col-md-8">
 						<p>Copyright Â© Jichao Ouyang</p>
						<p> Powered by <a rel="nofollow" href="http://blogist.github.io">Blogist</a> <span class="glyphicon glyphicon-heart"></span> <a href="http://github.com/jcouyang/kokaku">Kokaku</a> and <a href="https://gist.github.com">Gist</a> </p>
					</div>
				</div>
        <div class="col-md-2">
				</div>


      </div>

    </footer>
	</body>
</html>
